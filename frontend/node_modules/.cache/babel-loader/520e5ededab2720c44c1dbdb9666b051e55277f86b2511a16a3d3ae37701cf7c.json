{"ast":null,"code":"import{Routes,Route,Navigate,useNavigate}from\"react-router-dom\";import Login from\"./pages/Login\";import NotFound from\"./pages/404\";import{Suspense,useCallback,useEffect}from\"react\";import{Slide,ToastContainer}from\"react-toastify\";import\"react-toastify/dist/ReactToastify.css\";import{useStoreActions}from\"easy-peasy\";import{jwtDecode}from\"jwt-decode\";import{appRoutes}from\"./routes\";import ScrollToTop from\"./components/ScrollToTop\";import ForgotPassword from\"./pages/users/ForgotPassword\";import ResetPassword from\"./pages/users/ResetPassword\";import\"./index.css\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function App(){const authKey=localStorage.getItem(\"jwt\");const setUser=useStoreActions(state=>state.setUser);const navigate=useNavigate();const isTokenExpired=useCallback(token=>{const payloadBase64=token.split(\".\")[1];const decodedJson=atob(payloadBase64);const decoded=JSON.parse(decodedJson);const exp=decoded.exp;const now=Date.now().valueOf()/1000;return now>exp;},[]);useEffect(()=>{document.title=\"Khamco Shop\";const isLoggedIn=()=>{const token=authKey;return token!=null&&!isTokenExpired(token);};if(!isLoggedIn()){localStorage.clear();}const getUser=()=>{if(authKey){try{const decoded=jwtDecode(authKey);setUser({id:decoded.id,email:decoded.email,role:decoded.role,language:decoded.language});}catch(error){console.error(error);}}};getUser();},[authKey,isTokenExpired,navigate,setUser]);return/*#__PURE__*/_jsxs(Suspense,{fallback:/*#__PURE__*/_jsx(\"div\",{className:\"w-screen h-screen flex items-center justify-center\",children:/*#__PURE__*/_jsx(\"i\",{className:\"text-[5rem] text-khamco-ribbon fas fa-spinner animate-spin\"})}),children:[/*#__PURE__*/_jsx(ScrollToTop,{}),/*#__PURE__*/_jsxs(Routes,{children:[/*#__PURE__*/_jsx(Route,{exact:true,path:\"/users/login\",element:/*#__PURE__*/_jsx(Login,{})}),appRoutes.map(route=>/*#__PURE__*/_jsx(Route,{exact:true,path:route.path,element:authKey?/*#__PURE__*/_jsx(route.component,{}):/*#__PURE__*/_jsx(Navigate,{to:\"/users/login\"})},route.path)),/*#__PURE__*/_jsx(Route,{exact:true,path:\"/users/forgot-password\",element:/*#__PURE__*/_jsx(ForgotPassword,{})}),/*#__PURE__*/_jsx(Route,{exact:true,path:\"/users/reset-password/:token\",element:/*#__PURE__*/_jsx(ResetPassword,{})}),/*#__PURE__*/_jsx(Route,{exact:true,path:\"/unauthorized\",element:/*#__PURE__*/_jsx(NotFound,{})}),/*#__PURE__*/_jsx(Route,{exact:true,path:\"*\",element:/*#__PURE__*/_jsx(NotFound,{})})]}),/*#__PURE__*/_jsx(ToastContainer,{position:\"top-right\",hideProgressBar:false,newestOnTop:true,closeOnClick:true,rtl:false,pauseOnFocusLoss:true,draggable:true,pauseOnHover:true,theme:\"light\",transition:Slide,autoClose:5000})]});}export default App;","map":{"version":3,"names":["Routes","Route","Navigate","useNavigate","Login","NotFound","Suspense","useCallback","useEffect","Slide","ToastContainer","useStoreActions","jwtDecode","appRoutes","ScrollToTop","ForgotPassword","ResetPassword","jsx","_jsx","jsxs","_jsxs","App","authKey","localStorage","getItem","setUser","state","navigate","isTokenExpired","token","payloadBase64","split","decodedJson","atob","decoded","JSON","parse","exp","now","Date","valueOf","document","title","isLoggedIn","clear","getUser","id","email","role","language","error","console","fallback","className","children","exact","path","element","map","route","component","to","position","hideProgressBar","newestOnTop","closeOnClick","rtl","pauseOnFocusLoss","draggable","pauseOnHover","theme","transition","autoClose"],"sources":["C:/Users/TawandaMsengezi/Documents/Upwork/Osama-Client/Khamco Shop/Shop-1/client/src/App.js"],"sourcesContent":["import { Routes, Route, Navigate, useNavigate } from \"react-router-dom\";\nimport Login from \"./pages/Login\";\nimport NotFound from \"./pages/404\";\nimport { Suspense, useCallback, useEffect } from \"react\";\nimport { Slide, ToastContainer } from \"react-toastify\";\nimport \"react-toastify/dist/ReactToastify.css\";\nimport { useStoreActions } from \"easy-peasy\";\nimport { jwtDecode } from \"jwt-decode\";\nimport { appRoutes } from \"./routes\";\nimport ScrollToTop from \"./components/ScrollToTop\";\nimport ForgotPassword from \"./pages/users/ForgotPassword\";\nimport ResetPassword from \"./pages/users/ResetPassword\";\nimport \"./index.css\";\n\nfunction App() {\n  const authKey = localStorage.getItem(\"jwt\");\n  const setUser = useStoreActions((state) => state.setUser);\n  const navigate = useNavigate();\n\n  const isTokenExpired = useCallback((token) => {\n    const payloadBase64 = token.split(\".\")[1];\n    const decodedJson = atob(payloadBase64);\n    const decoded = JSON.parse(decodedJson);\n    const exp = decoded.exp;\n    const now = Date.now().valueOf() / 1000;\n    return now > exp;\n  }, []);\n\n  useEffect(() => {\n    document.title = \"Khamco Shop\";\n\n    const isLoggedIn = () => {\n      const token = authKey;\n      return token != null && !isTokenExpired(token);\n    };\n\n    if (!isLoggedIn()) {\n      localStorage.clear();\n    }\n\n    const getUser = () => {\n      if (authKey) {\n        try {\n          const decoded = jwtDecode(authKey);\n          setUser({\n            id: decoded.id,\n            email: decoded.email,\n            role: decoded.role,\n            language: decoded.language,\n          });\n        } catch (error) {\n          console.error(error);\n        }\n      }\n    };\n    getUser();\n  }, [authKey, isTokenExpired, navigate, setUser]);\n\n  return (\n    <Suspense\n      fallback={\n        <div className=\"w-screen h-screen flex items-center justify-center\">\n          <i className=\"text-[5rem] text-khamco-ribbon fas fa-spinner animate-spin\"></i>\n        </div>\n      }\n    >\n      <ScrollToTop />\n      <Routes>\n        <Route exact path=\"/users/login\" element={<Login />} />\n        {appRoutes.map((route) => (\n          <Route\n            key={route.path}\n            exact\n            path={route.path}\n            element={\n              authKey ? <route.component /> : <Navigate to=\"/users/login\" />\n            }\n          />\n        ))}\n        {/* Misc Routes */}\n        <Route\n          exact\n          path=\"/users/forgot-password\"\n          element={<ForgotPassword />}\n        />\n        <Route exact path=\"/users/reset-password/:token\" element={<ResetPassword />} />\n        <Route exact path=\"/unauthorized\" element={<NotFound />} />\n        <Route exact path=\"*\" element={<NotFound />} />\n      </Routes>\n      <ToastContainer\n        position=\"top-right\"\n        hideProgressBar={false}\n        newestOnTop={true}\n        closeOnClick\n        rtl={false}\n        pauseOnFocusLoss\n        draggable\n        pauseOnHover\n        theme=\"light\"\n        transition={Slide}\n        autoClose={5000}\n      />\n    </Suspense>\n  );\n}\n\nexport default App;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}