{"ast":null,"code":"import React,{useEffect,useState}from\"react\";import Navbar from\"../../components/Navbar\";import AdminPanel from\"../../components/AdminPanel\";import UserForm from\"./UserForm\";import Footer from\"../../components/Footer\";import{useNavigate,useParams}from\"react-router-dom\";import axios from\"axios\";import{toast}from\"react-toastify\";import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const EditUser=()=>{const{id}=useParams();const[checkMaster,setCheckMaster]=useState(null);const[authorizedUser,setAuthorizedUser]=useState(null);const navigate=useNavigate();const authKey=localStorage.getItem(\"jwt\");const apiUrl=window.location.origin.includes(\"localhost\")?\"http://localhost:5000/admin/users/\".concat(id):\"https://khamco-shop-backend.onrender.com/admin/users/\".concat(id);const[firstName,setFirstName]=useState(\"\");const[lastName,setLastName]=useState(\"\");const[role,setRole]=useState(\"\");const[language,setLanguage]=useState(\"\");const[email,setEmail]=useState(\"\");const[oldPassword,setOldPassword]=useState(\"\");const[password,setPassword]=useState(\"\");const[confirmPassword,setConfirmPassword]=useState(\"\");const[loading,setLoading]=useState(false);useEffect(()=>{document.title=\"Edit User Details - Khamco Shop\";const fetchUserData=async()=>{try{const response=await axios.get(apiUrl,{headers:{Authorization:\"Bearer \".concat(authKey)}});setFirstName(response.data.user.name);setLastName(response.data.user.surname);setRole(response.data.user.role);setLanguage(response.data.user.language);setEmail(response.data.user.email);}catch(error){if(error.response){if(error.response.status===403){toast.warn(\"You are not authorized to access that page\");navigate(\"/\");}else{var _error$response$data;toast.error(((_error$response$data=error.response.data)===null||_error$response$data===void 0?void 0:_error$response$data.message)||error.message);}}}};fetchUserData();},[apiUrl,authKey,navigate]);const handleSubmit=async e=>{e.preventDefault();setLoading(true);if(oldPassword&&!password){setLoading(false);toast.info(\"Please enter a new password\");return;}if(password!==confirmPassword){setLoading(false);toast.info(\"New passwords do not match\");return;}try{const response=await axios.put(apiUrl,{name:firstName,surname:lastName,email:email,role:role,language:language,old_password:oldPassword,password:password,password2:confirmPassword},{headers:{Authorization:\"Bearer \".concat(authKey)}});toast.success(response.data.message);navigate(\"/admin/users/\".concat(response.data.user._id));setLoading(false);}catch(error){setLoading(false);if(error.response){if(error.response.status===403){toast.warn(\"You are not authorized\");}else{var _error$response$data2;toast.error(((_error$response$data2=error.response.data)===null||_error$response$data2===void 0?void 0:_error$response$data2.message)||error.message);}}}};return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Navbar,{}),/*#__PURE__*/_jsxs(\"main\",{children:[/*#__PURE__*/_jsx(AdminPanel,{}),/*#__PURE__*/_jsxs(\"section\",{children:[/*#__PURE__*/_jsx(\"h1\",{className:\"title\",children:\"Edit Tailor Details\"}),/*#__PURE__*/_jsx(\"form\",{onSubmit:handleSubmit,className:\"flex flex-col justify-center items-center w-[90vw]\",children:/*#__PURE__*/_jsx(UserForm,{page:\"edit\",checkMaster:checkMaster,authorizedUser:authorizedUser,loading:loading,setFirstName:setFirstName,setLastName:setLastName,setRole:setRole,setLanguage:setLanguage,setEmail:setEmail,setOldPassword:setOldPassword,setPassword:setPassword,setConfirmPassword:setConfirmPassword,firstName:firstName,lastName:lastName,role:role,language:language,email:email})})]})]}),/*#__PURE__*/_jsx(Footer,{})]});};export default EditUser;","map":{"version":3,"names":["React","useEffect","useState","Navbar","AdminPanel","UserForm","Footer","useNavigate","useParams","axios","toast","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","EditUser","id","checkMaster","setCheckMaster","authorizedUser","setAuthorizedUser","navigate","authKey","localStorage","getItem","apiUrl","window","location","origin","includes","concat","firstName","setFirstName","lastName","setLastName","role","setRole","language","setLanguage","email","setEmail","oldPassword","setOldPassword","password","setPassword","confirmPassword","setConfirmPassword","loading","setLoading","document","title","fetchUserData","response","get","headers","Authorization","data","user","name","surname","error","status","warn","_error$response$data","message","handleSubmit","e","preventDefault","info","put","old_password","password2","success","_id","_error$response$data2","children","className","onSubmit","page"],"sources":["C:/Users/TawandaMsengezi/Documents/Upwork/Osama-Client/Khamco Shop/Shop-1/client/src/pages/users/EditUser.jsx"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport Navbar from \"../../components/Navbar\";\r\nimport AdminPanel from \"../../components/AdminPanel\";\r\nimport UserForm from \"./UserForm\";\r\nimport Footer from \"../../components/Footer\";\r\nimport { useNavigate, useParams } from \"react-router-dom\";\r\nimport axios from \"axios\";\r\nimport { toast } from \"react-toastify\";\r\n\r\nconst EditUser = () => {\r\n  const { id } = useParams();\r\n  const [checkMaster, setCheckMaster] = useState(null);\r\n  const [authorizedUser, setAuthorizedUser] = useState(null);\r\n  const navigate = useNavigate();\r\n  const authKey = localStorage.getItem(\"jwt\");\r\n  const apiUrl = window.location.origin.includes(\"localhost\")\r\n    ? `http://localhost:5000/admin/users/${id}`\r\n    : `https://khamco-shop-backend.onrender.com/admin/users/${id}`;\r\n  const [firstName, setFirstName] = useState(\"\");\r\n  const [lastName, setLastName] = useState(\"\");\r\n  const [role, setRole] = useState(\"\");\r\n  const [language, setLanguage] = useState(\"\");\r\n  const [email, setEmail] = useState(\"\");\r\n  const [oldPassword, setOldPassword] = useState(\"\");\r\n  const [password, setPassword] = useState(\"\");\r\n  const [confirmPassword, setConfirmPassword] = useState(\"\");\r\n  const [loading, setLoading] = useState(false);\r\n\r\n  useEffect(() => {\r\n    document.title = \"Edit User Details - Khamco Shop\";\r\n\r\n    const fetchUserData = async () => {\r\n      try {\r\n        const response = await axios.get(apiUrl, {\r\n          headers: { Authorization: `Bearer ${authKey}` },\r\n        });\r\n        setFirstName(response.data.user.name);\r\n        setLastName(response.data.user.surname);\r\n        setRole(response.data.user.role);\r\n        setLanguage(response.data.user.language);\r\n        setEmail(response.data.user.email);\r\n      } catch (error) {\r\n        if (error.response) {\r\n          if (error.response.status === 403) {\r\n            toast.warn(\"You are not authorized to access that page\");\r\n            navigate(\"/\");\r\n          } else {\r\n            toast.error(error.response.data?.message || error.message);\r\n          }\r\n        }\r\n      }\r\n    };\r\n\r\n    fetchUserData();\r\n  }, [apiUrl, authKey, navigate]);\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    setLoading(true);\r\n    \r\n    if(oldPassword && !password){\r\n      setLoading(false);\r\n      toast.info(\"Please enter a new password\");\r\n      return;\r\n    }\r\n    \r\n    if(password !== confirmPassword){\r\n      setLoading(false);\r\n      toast.info(\"New passwords do not match\");\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const response = await axios.put(\r\n        apiUrl,\r\n        {\r\n          name: firstName,\r\n          surname: lastName,\r\n          email: email,\r\n          role: role,\r\n          language: language,\r\n          old_password: oldPassword,\r\n          password: password,\r\n          password2: confirmPassword,\r\n        },\r\n        {\r\n          headers: { Authorization: `Bearer ${authKey}` },\r\n        }\r\n      );\r\n      toast.success(response.data.message);\r\n      navigate(`/admin/users/${response.data.user._id}`);\r\n      setLoading(false);\r\n    } catch (error) {\r\n      setLoading(false);\r\n      if (error.response) {\r\n        if (error.response.status === 403) {\r\n          toast.warn(\"You are not authorized\");\r\n        } else {\r\n          toast.error(error.response.data?.message || error.message);\r\n        }\r\n      }\r\n    }\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <Navbar />\r\n      <main>\r\n        <AdminPanel />\r\n        <section>\r\n          <h1 className=\"title\">Edit Tailor Details</h1>\r\n          <form\r\n            onSubmit={handleSubmit}\r\n            className=\"flex flex-col justify-center items-center w-[90vw]\"\r\n          >\r\n            <UserForm\r\n              page=\"edit\"\r\n              checkMaster={checkMaster}\r\n              authorizedUser={authorizedUser}\r\n              loading={loading}\r\n              setFirstName={setFirstName}\r\n              setLastName={setLastName}\r\n              setRole={setRole}\r\n              setLanguage={setLanguage}\r\n              setEmail={setEmail}\r\n              setOldPassword={setOldPassword}\r\n              setPassword={setPassword}\r\n              setConfirmPassword={setConfirmPassword}\r\n              firstName={firstName}\r\n              lastName={lastName}\r\n              role={role}\r\n              language={language}\r\n              email={email}\r\n            />\r\n          </form>\r\n        </section>\r\n      </main>\r\n      <Footer />\r\n    </>\r\n  );\r\n};\r\n\r\nexport default EditUser;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}