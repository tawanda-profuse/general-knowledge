{"ast":null,"code":"import axios from\"axios\";import{useEffect,useState}from\"react\";import{Link,useNavigate,useParams}from\"react-router-dom\";import{toast}from\"react-toastify\";import Navbar from\"../../components/Navbar\";import Footer from\"../../components/Footer\";import{applyAnimation}from\"../../functions\";import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const MyOrders=()=>{const{id}=useParams();const navigate=useNavigate();const serverUrl=window.location.origin.includes(\"localhost\")?\"http://localhost:5000\":\"https://khamco-shop-backend.onrender.com\";const authKey=localStorage.getItem(\"jwt\");const[orders,setOrders]=useState([]);const[user,setUser]=useState({});const[isLoading,setIsLoading]=useState(true);useEffect(()=>{let isMounted=true;document.title=\"Order Management\";const fetchData=async()=>{await axios.get(\"\".concat(serverUrl,\"/orders/my-orders/\").concat(id),{headers:{Authorization:\"Bearer \".concat(authKey)}}).then(response=>{if(isMounted){setOrders(response.data.orders);setIsLoading(false);setUser(response.data.user);document.title=\"Order Management - \".concat(response.data.user.name);}}).catch(error=>{if(isMounted){setIsLoading(false);if(error.response.status===403){toast.warn(\"You are not authorized to access that page\");navigate(\"/\");}else{var _error$response,_error$response$data;toast.error(((_error$response=error.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:_error$response$data.message)||error.message);}return;}});};fetchData();return()=>{isMounted=false;};},[authKey,id,navigate,serverUrl]);const determineDuty=order=>{const activeUser=\"\".concat(user.name,\" \").concat(user.surname);let roles=[];if(activeUser===order.measurer){roles.push(\"Measuring\");}if(activeUser===order.sewer){roles.push(\"Sewing\");}if(activeUser===order.cutter){roles.push(\"Cutting\");}return roles.join(\", \");};return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Navbar,{}),/*#__PURE__*/_jsx(\"main\",{children:/*#__PURE__*/_jsxs(\"section\",{className:\"py-0 px-[2rem] justify-center items-center grid-cols-1 gap-[1rem]\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"utilities\",children:/*#__PURE__*/_jsxs(Link,{to:\"/orders\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-arrow-left\"}),\" Back to Orders\"]})}),isLoading&&/*#__PURE__*/_jsxs(\"table\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsx(\"tr\",{children:/*#__PURE__*/_jsx(\"td\",{children:\"Loading...\"})})}),/*#__PURE__*/_jsxs(\"tbody\",{children:[/*#__PURE__*/_jsx(\"tr\",{className:\"bg-[#aaa] animate-pulse text-[#aaa] h-12\",children:/*#__PURE__*/_jsx(\"td\",{children:\"k\"})}),/*#__PURE__*/_jsx(\"tr\",{className:\"bg-[#aaa] animate-pulse text-[#aaa] h-12\",children:/*#__PURE__*/_jsx(\"td\",{children:\"k\"})}),/*#__PURE__*/_jsx(\"tr\",{className:\"bg-[#aaa] animate-pulse text-[#aaa] h-12\",children:/*#__PURE__*/_jsx(\"td\",{children:\"k\"})})]})]}),orders&&orders.length>0?/*#__PURE__*/_jsxs(\"table\",{children:[/*#__PURE__*/_jsx(\"caption\",{children:\"My Orders\"}),/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:\"Date\"}),/*#__PURE__*/_jsx(\"td\",{children:\"Status\"}),/*#__PURE__*/_jsx(\"td\",{children:\"Duty\"}),/*#__PURE__*/_jsx(\"td\",{})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:orders.map((order,index)=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:new Date(order.order_date).toLocaleDateString(\"en-us\",{month:\"long\",day:\"numeric\",year:\"numeric\"})}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"span\",{className:\"\".concat(applyAnimation(order.order_status),\" p-[0.2rem] rounded-[0.7rem]\"),children:order.order_status})}),/*#__PURE__*/_jsx(\"td\",{className:\"flex flex-col\",children:determineDuty(order)}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsxs(Link,{to:\"/orders/\".concat(order._id),target:\"_blank\",children:[\"Details \",/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-external-link\"})]})})]},index))})]}):/*#__PURE__*/_jsx(\"p\",{className:\"text-center my-[2rem] animate-pulse text-lg text-[orangered]\",children:\"You have no orders...\"})]})}),/*#__PURE__*/_jsx(Footer,{})]});};export default MyOrders;","map":{"version":3,"names":["axios","useEffect","useState","Link","useNavigate","useParams","toast","Navbar","Footer","applyAnimation","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","MyOrders","id","navigate","serverUrl","window","location","origin","includes","authKey","localStorage","getItem","orders","setOrders","user","setUser","isLoading","setIsLoading","isMounted","document","title","fetchData","get","concat","headers","Authorization","then","response","data","name","catch","error","status","warn","_error$response","_error$response$data","message","determineDuty","order","activeUser","surname","roles","measurer","push","sewer","cutter","join","children","className","to","length","map","index","Date","order_date","toLocaleDateString","month","day","year","order_status","_id","target"],"sources":["C:/Users/TawandaMsengezi/Documents/Upwork/Osama-Client/Khamco Shop/Shop-1/client/src/pages/orders/MyOrders.jsx"],"sourcesContent":["import axios from \"axios\";\r\nimport { useEffect, useState } from \"react\";\r\nimport { Link, useNavigate, useParams } from \"react-router-dom\";\r\nimport { toast } from \"react-toastify\";\r\nimport Navbar from \"../../components/Navbar\";\r\nimport Footer from \"../../components/Footer\";\r\nimport { applyAnimation } from \"../../functions\";\r\n\r\nconst MyOrders = () => {\r\n  const { id } = useParams();\r\n  const navigate = useNavigate();\r\n  const serverUrl = window.location.origin.includes(\"localhost\")\r\n    ? \"http://localhost:5000\"\r\n    : \"https://khamco-shop-backend.onrender.com\";\r\n  const authKey = localStorage.getItem(\"jwt\");\r\n  const [orders, setOrders] = useState([]);\r\n  const [user, setUser] = useState({});\r\n  const [isLoading, setIsLoading] = useState(true);\r\n\r\n  useEffect(() => {\r\n    let isMounted = true;\r\n\r\n    document.title = \"Order Management\";\r\n\r\n    const fetchData = async () => {\r\n      await axios\r\n        .get(`${serverUrl}/orders/my-orders/${id}`, {\r\n          headers: { Authorization: `Bearer ${authKey}` },\r\n        })\r\n        .then((response) => {\r\n          if (isMounted) {\r\n            setOrders(response.data.orders);\r\n            setIsLoading(false);\r\n            setUser(response.data.user);\r\n            document.title = `Order Management - ${response.data.user.name}`;\r\n          }\r\n        })\r\n        .catch((error) => {\r\n          if (isMounted) {\r\n            setIsLoading(false);\r\n            if (error.response.status === 403) {\r\n              toast.warn(\"You are not authorized to access that page\");\r\n              navigate(\"/\");\r\n            } else {\r\n              toast.error(error.response?.data?.message || error.message);\r\n            }\r\n            return;\r\n          }\r\n        });\r\n    };\r\n\r\n    fetchData();\r\n\r\n    return () => {\r\n      isMounted = false;\r\n    };\r\n  }, [authKey, id, navigate, serverUrl]);\r\n\r\n  const determineDuty = (order) => {\r\n    const activeUser = `${user.name} ${user.surname}`;\r\n    let roles = [];\r\n    if (activeUser === order.measurer) {\r\n      roles.push(\"Measuring\");\r\n    }\r\n\r\n    if (activeUser === order.sewer) {\r\n      roles.push(\"Sewing\");\r\n    }\r\n\r\n    if (activeUser === order.cutter) {\r\n      roles.push(\"Cutting\");\r\n    }\r\n\r\n    return roles.join(\", \");\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <Navbar />\r\n      <main>\r\n        <section className=\"py-0 px-[2rem] justify-center items-center grid-cols-1 gap-[1rem]\">\r\n          <div className=\"utilities\">\r\n            <Link to=\"/orders\">\r\n              <i className=\"fas fa-arrow-left\"></i> Back to Orders\r\n            </Link>\r\n          </div>\r\n          {isLoading && (\r\n            <table className=\"text-center\">\r\n              <thead>\r\n                <tr>\r\n                  <td>Loading...</td>\r\n                </tr>\r\n              </thead>\r\n              <tbody>\r\n                <tr className=\"bg-[#aaa] animate-pulse text-[#aaa] h-12\">\r\n                  <td>k</td>\r\n                </tr>\r\n                <tr className=\"bg-[#aaa] animate-pulse text-[#aaa] h-12\">\r\n                  <td>k</td>\r\n                </tr>\r\n                <tr className=\"bg-[#aaa] animate-pulse text-[#aaa] h-12\">\r\n                  <td>k</td>\r\n                </tr>\r\n              </tbody>\r\n            </table>\r\n          )}\r\n          {orders && orders.length > 0 ? (\r\n            <table>\r\n              <caption>My Orders</caption>\r\n              <thead>\r\n                <tr>\r\n                  <td>Date</td>\r\n                  <td>Status</td>\r\n                  <td>Duty</td>\r\n                  <td></td>\r\n                </tr>\r\n              </thead>\r\n              <tbody>\r\n                {orders.map((order, index) => (\r\n                  <tr key={index}>\r\n                    <td>\r\n                      {new Date(order.order_date).toLocaleDateString(\"en-us\", {\r\n                        month: \"long\",\r\n                        day: \"numeric\",\r\n                        year: \"numeric\",\r\n                      })}\r\n                    </td>\r\n                    <td>\r\n                      <span\r\n                        className={`${applyAnimation(\r\n                          order.order_status\r\n                        )} p-[0.2rem] rounded-[0.7rem]`}\r\n                      >\r\n                        {order.order_status}\r\n                      </span>\r\n                    </td>\r\n                    <td className=\"flex flex-col\">{determineDuty(order)}</td>\r\n                    <td>\r\n                      <Link to={`/orders/${order._id}`} target=\"_blank\">\r\n                        Details <i className=\"fas fa-external-link\"></i>\r\n                      </Link>\r\n                    </td>\r\n                  </tr>\r\n                ))}\r\n              </tbody>\r\n            </table>\r\n          ) : (\r\n            <p className=\"text-center my-[2rem] animate-pulse text-lg text-[orangered]\">You have no orders...</p>\r\n          )}\r\n        </section>\r\n      </main>\r\n      <Footer />\r\n    </>\r\n  );\r\n};\r\n\r\nexport default MyOrders;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}