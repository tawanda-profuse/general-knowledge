{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\TawandaMsengezi\\\\Documents\\\\Upwork\\\\Osama-Client\\\\Khamco Shop\\\\Shop-1\\\\client\\\\src\\\\App.js\",\n  _s = $RefreshSig$();\nimport { Routes, Route, Navigate, useNavigate } from \"react-router-dom\";\nimport Login from \"./pages/Login\";\nimport NotFound from \"./pages/404\";\nimport { Suspense, useCallback, useEffect } from \"react\";\nimport { Slide, toast, ToastContainer } from \"react-toastify\";\nimport \"react-toastify/dist/ReactToastify.css\";\nimport { useStoreActions } from \"easy-peasy\";\nimport { jwtDecode } from \"jwt-decode\";\nimport { appRoutes } from \"./routes\";\nimport ScrollToTop from \"./components/ScrollToTop\";\nimport ForgotPassword from \"./pages/users/ForgotPassword\";\nimport ResetPassword from \"./pages/users/ResetPassword\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction App() {\n  _s();\n  const token = localStorage.getItem(\"jwt\");\n  const setUser = useStoreActions(state => state.setUser);\n  const navigate = useNavigate();\n  const isTokenExpired = useCallback(token => {\n    try {\n      const payloadBase64 = token.split(\".\")[1];\n      const decodedJson = atob(payloadBase64);\n      const decoded = JSON.parse(decodedJson);\n      const exp = decoded.exp;\n      const now = Date.now().valueOf() / 1000;\n      return now > exp;\n    } catch (error) {\n      console.error(\"Token parsing error:\", error);\n      return true; // Treat any error as an expired token\n    }\n  }, []);\n  useEffect(() => {\n    const token = localStorage.getItem(\"jwt\");\n    if (!token || isTokenExpired(token)) {\n      localStorage.clear();\n      navigate(\"/users/login\");\n      toast.warn(\"Session expired. Please log in again.\");\n    } else {\n      // Token is valid, proceed with user setup\n      const decoded = jwtDecode(token);\n      setUser({\n        id: decoded.id,\n        email: decoded.email,\n        role: decoded.role,\n        language: decoded.language\n      });\n    }\n  }, [isTokenExpired, navigate, setUser]);\n  return /*#__PURE__*/_jsxDEV(Suspense, {\n    fallback: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"w-screen h-screen flex items-center justify-center\",\n      children: /*#__PURE__*/_jsxDEV(\"i\", {\n        className: \"text-[5rem] text-khamco-ribbon fas fa-spinner animate-spin\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 57,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 56,\n      columnNumber: 9\n    }, this),\n    children: [/*#__PURE__*/_jsxDEV(ScrollToTop, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 61,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Routes, {\n      children: [/*#__PURE__*/_jsxDEV(Route, {\n        exact: true,\n        path: \"/users/login\",\n        element: /*#__PURE__*/_jsxDEV(Login, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 63,\n          columnNumber: 51\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 63,\n        columnNumber: 9\n      }, this), appRoutes.map(route => /*#__PURE__*/_jsxDEV(Route, {\n        exact: true,\n        path: route.path,\n        element: authKey ? /*#__PURE__*/_jsxDEV(route.component, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 70,\n          columnNumber: 25\n        }, this) : /*#__PURE__*/_jsxDEV(Navigate, {\n          to: \"/users/login\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 70,\n          columnNumber: 47\n        }, this)\n      }, route.path, false, {\n        fileName: _jsxFileName,\n        lineNumber: 65,\n        columnNumber: 11\n      }, this)), /*#__PURE__*/_jsxDEV(Route, {\n        exact: true,\n        path: \"/users/forgot-password\",\n        element: /*#__PURE__*/_jsxDEV(ForgotPassword, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 78,\n          columnNumber: 20\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 75,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Route, {\n        exact: true,\n        path: \"/users/reset-password/:token\",\n        element: /*#__PURE__*/_jsxDEV(ResetPassword, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 80,\n          columnNumber: 67\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 80,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Route, {\n        exact: true,\n        path: \"/unauthorized\",\n        element: /*#__PURE__*/_jsxDEV(NotFound, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 81,\n          columnNumber: 52\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 81,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Route, {\n        exact: true,\n        path: \"*\",\n        element: /*#__PURE__*/_jsxDEV(NotFound, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 82,\n          columnNumber: 40\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 82,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(ToastContainer, {\n      position: \"top-right\",\n      hideProgressBar: false,\n      newestOnTop: true,\n      closeOnClick: true,\n      rtl: false,\n      pauseOnFocusLoss: true,\n      draggable: true,\n      pauseOnHover: true,\n      theme: \"light\",\n      transition: Slide,\n      autoClose: 5000\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 54,\n    columnNumber: 5\n  }, this);\n}\n_s(App, \"GCE9ZRqqe5G/xZApPDuqWw/IaXo=\", false, function () {\n  return [useStoreActions, useNavigate];\n});\n_c = App;\nexport default App;\nvar _c;\n$RefreshReg$(_c, \"App\");","map":{"version":3,"names":["Routes","Route","Navigate","useNavigate","Login","NotFound","Suspense","useCallback","useEffect","Slide","toast","ToastContainer","useStoreActions","jwtDecode","appRoutes","ScrollToTop","ForgotPassword","ResetPassword","jsxDEV","_jsxDEV","App","_s","token","localStorage","getItem","setUser","state","navigate","isTokenExpired","payloadBase64","split","decodedJson","atob","decoded","JSON","parse","exp","now","Date","valueOf","error","console","clear","warn","id","email","role","language","fallback","className","children","fileName","_jsxFileName","lineNumber","columnNumber","exact","path","element","map","route","authKey","component","to","position","hideProgressBar","newestOnTop","closeOnClick","rtl","pauseOnFocusLoss","draggable","pauseOnHover","theme","transition","autoClose","_c","$RefreshReg$"],"sources":["C:/Users/TawandaMsengezi/Documents/Upwork/Osama-Client/Khamco Shop/Shop-1/client/src/App.js"],"sourcesContent":["import { Routes, Route, Navigate, useNavigate } from \"react-router-dom\";\nimport Login from \"./pages/Login\";\nimport NotFound from \"./pages/404\";\nimport { Suspense, useCallback, useEffect } from \"react\";\nimport { Slide, toast, ToastContainer } from \"react-toastify\";\nimport \"react-toastify/dist/ReactToastify.css\";\nimport { useStoreActions } from \"easy-peasy\";\nimport { jwtDecode } from \"jwt-decode\";\nimport { appRoutes } from \"./routes\";\nimport ScrollToTop from \"./components/ScrollToTop\";\nimport ForgotPassword from \"./pages/users/ForgotPassword\";\nimport ResetPassword from \"./pages/users/ResetPassword\";\n\nfunction App() {\n  const token = localStorage.getItem(\"jwt\");\n  const setUser = useStoreActions((state) => state.setUser);\n  const navigate = useNavigate();\n\n  const isTokenExpired = useCallback((token) => {\n    try {\n      const payloadBase64 = token.split(\".\")[1];\n      const decodedJson = atob(payloadBase64);\n      const decoded = JSON.parse(decodedJson);\n      const exp = decoded.exp;\n      const now = Date.now().valueOf() / 1000;\n      return now > exp;\n    } catch (error) {\n      console.error(\"Token parsing error:\", error);\n      return true; // Treat any error as an expired token\n    }\n  }, []);\n\n  useEffect(() => {\n    const token = localStorage.getItem(\"jwt\");\n    \n    if (!token || isTokenExpired(token)) {\n      localStorage.clear();\n      navigate(\"/users/login\");\n      toast.warn(\"Session expired. Please log in again.\");\n    } else {\n      // Token is valid, proceed with user setup\n      const decoded = jwtDecode(token);\n      setUser({\n        id: decoded.id,\n        email: decoded.email,\n        role: decoded.role,\n        language: decoded.language,\n      });\n    }\n  }, [isTokenExpired, navigate, setUser]);\n  \n\n  return (\n    <Suspense\n      fallback={\n        <div className=\"w-screen h-screen flex items-center justify-center\">\n          <i className=\"text-[5rem] text-khamco-ribbon fas fa-spinner animate-spin\"></i>\n        </div>\n      }\n    >\n      <ScrollToTop />\n      <Routes>\n        <Route exact path=\"/users/login\" element={<Login />} />\n        {appRoutes.map((route) => (\n          <Route\n            key={route.path}\n            exact\n            path={route.path}\n            element={\n              authKey ? <route.component /> : <Navigate to=\"/users/login\" />\n            }\n          />\n        ))}\n        {/* Misc Routes */}\n        <Route\n          exact\n          path=\"/users/forgot-password\"\n          element={<ForgotPassword />}\n        />\n        <Route exact path=\"/users/reset-password/:token\" element={<ResetPassword />} />\n        <Route exact path=\"/unauthorized\" element={<NotFound />} />\n        <Route exact path=\"*\" element={<NotFound />} />\n      </Routes>\n      <ToastContainer\n        position=\"top-right\"\n        hideProgressBar={false}\n        newestOnTop={true}\n        closeOnClick\n        rtl={false}\n        pauseOnFocusLoss\n        draggable\n        pauseOnHover\n        theme=\"light\"\n        transition={Slide}\n        autoClose={5000}\n      />\n    </Suspense>\n  );\n}\n\nexport default App;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}