{"ast":null,"code":"import{useEffect,useState}from\"react\";import Navbar from\"../../components/Navbar\";import AdminPanel from\"../../components/AdminPanel\";import Footer from\"../../components/Footer\";import UserForm from\"./UserForm\";import{useNavigate}from\"react-router-dom\";import axios from\"axios\";import{toast}from\"react-toastify\";import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const RegisterUser=()=>{const serverUrl=window.location.origin.includes(\"localhost\")?\"http://localhost:5000/admin\":\"https://khamco-shop-backend.onrender.com/admin\";const[checkMaster,setCheckMaster]=useState(null);const[authorizedUser,setAuthorizedUser]=useState(null);const navigate=useNavigate();const authKey=localStorage.getItem(\"jwt\");const[loading,setLoading]=useState(false);const[firstName,setFirstName]=useState(\"\");const[lastName,setLastName]=useState(\"\");const[role,setRole]=useState(\"\");const[language,setLanguage]=useState(\"en\");const[email,setEmail]=useState(\"\");const[password,setPassword]=useState(\"\");const[confirmPassword,setConfirmPassword]=useState(\"\");useEffect(()=>{let isMounted=true;document.title=\"User Registration - Khamco Shop\";const fetchData=async()=>{await axios.get(\"\".concat(serverUrl,\"/register-user\"),{headers:{Authorization:\"Bearer \".concat(authKey)}}).then(response=>{if(isMounted){setCheckMaster(response.data.checkMaster);setAuthorizedUser(response.data.authorizedUser);}}).catch(error=>{if(isMounted){if(error.response.status===403){toast.warn(\"You are not authorized to access that page\");navigate(\"/\");}else{var _error$response,_error$response$data;toast.error(((_error$response=error.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:_error$response$data.message)||error.message);}return;}});};fetchData();return()=>{isMounted=false;};},[authKey,navigate,serverUrl]);const handleSubmit=async e=>{e.preventDefault();setLoading(true);try{const response=await axios.post(\"\".concat(serverUrl,\"/register\"),{name:firstName,surname:lastName,email:email,role:role,language:language,password:password,password2:confirmPassword},{headers:{Authorization:\"Bearer \".concat(authKey)}});toast.success(response.data.message);setCheckMaster(response.data.checkMaster);setAuthorizedUser(response.data.authorizedUser);navigate(\"/admin/users/\".concat(response.data.user._id));setLoading(false);}catch(error){var _error$response2,_error$response2$data;setLoading(false);toast.error(((_error$response2=error.response)===null||_error$response2===void 0?void 0:(_error$response2$data=_error$response2.data)===null||_error$response2$data===void 0?void 0:_error$response2$data.message)||error.message);}};return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Navbar,{}),/*#__PURE__*/_jsxs(\"main\",{children:[/*#__PURE__*/_jsx(AdminPanel,{}),/*#__PURE__*/_jsxs(\"section\",{children:[/*#__PURE__*/_jsx(\"h1\",{className:\"title\",children:\"Register User\"}),/*#__PURE__*/_jsx(\"form\",{onSubmit:handleSubmit,className:\"flex flex-col justify-center items-center w-[90vw]\",children:/*#__PURE__*/_jsx(UserForm,{page:\"register\",checkMaster:checkMaster,authorizedUser:authorizedUser,loading:loading,setFirstName:setFirstName,setLastName:setLastName,setRole:setRole,setLanguage:setLanguage,setEmail:setEmail,setPassword:setPassword,setConfirmPassword:setConfirmPassword})})]})]}),/*#__PURE__*/_jsx(Footer,{})]});};export default RegisterUser;","map":{"version":3,"names":["useEffect","useState","Navbar","AdminPanel","Footer","UserForm","useNavigate","axios","toast","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","RegisterUser","serverUrl","window","location","origin","includes","checkMaster","setCheckMaster","authorizedUser","setAuthorizedUser","navigate","authKey","localStorage","getItem","loading","setLoading","firstName","setFirstName","lastName","setLastName","role","setRole","language","setLanguage","email","setEmail","password","setPassword","confirmPassword","setConfirmPassword","isMounted","document","title","fetchData","get","concat","headers","Authorization","then","response","data","catch","error","status","warn","_error$response","_error$response$data","message","handleSubmit","e","preventDefault","post","name","surname","password2","success","user","_id","_error$response2","_error$response2$data","children","className","onSubmit","page"],"sources":["C:/Users/TawandaMsengezi/Documents/Upwork/Osama-Client/Khamco Shop/Shop-1/client/src/pages/users/RegisterUser.jsx"],"sourcesContent":["import { useEffect, useState } from \"react\";\r\nimport Navbar from \"../../components/Navbar\";\r\nimport AdminPanel from \"../../components/AdminPanel\";\r\nimport Footer from \"../../components/Footer\";\r\nimport UserForm from \"./UserForm\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport axios from \"axios\";\r\nimport { toast } from \"react-toastify\";\r\n\r\nconst RegisterUser = () => {\r\n  const serverUrl = window.location.origin.includes(\"localhost\")\r\n    ? \"http://localhost:5000/admin\"\r\n    : \"https://khamco-shop-backend.onrender.com/admin\";\r\n  const [checkMaster, setCheckMaster] = useState(null);\r\n  const [authorizedUser, setAuthorizedUser] = useState(null);\r\n  const navigate = useNavigate();\r\n  const authKey = localStorage.getItem(\"jwt\");\r\n  const [loading, setLoading] = useState(false);\r\n  const [firstName, setFirstName] = useState(\"\");\r\n  const [lastName, setLastName] = useState(\"\");\r\n  const [role, setRole] = useState(\"\");\r\n  const [language, setLanguage] = useState(\"en\");\r\n  const [email, setEmail] = useState(\"\");\r\n  const [password, setPassword] = useState(\"\");\r\n  const [confirmPassword, setConfirmPassword] = useState(\"\");\r\n\r\n  useEffect(() => {\r\n    let isMounted = true;\r\n\r\n    document.title = \"User Registration - Khamco Shop\";\r\n\r\n    const fetchData = async () => {\r\n      await axios\r\n        .get(`${serverUrl}/register-user`, {\r\n          headers: { Authorization: `Bearer ${authKey}` },\r\n        })\r\n        .then((response) => {\r\n          if (isMounted) {\r\n            setCheckMaster(response.data.checkMaster);\r\n            setAuthorizedUser(response.data.authorizedUser);\r\n          }\r\n        })\r\n        .catch((error) => {\r\n          if (isMounted) {\r\n            if (error.response.status === 403) {\r\n              toast.warn(\"You are not authorized to access that page\");\r\n              navigate(\"/\");\r\n            } else {\r\n              toast.error(error.response?.data?.message || error.message);\r\n            }\r\n            return;\r\n          }\r\n        });\r\n    };\r\n\r\n    fetchData();\r\n\r\n    return () => {\r\n      isMounted = false;\r\n    };\r\n  }, [authKey, navigate, serverUrl]);\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    setLoading(true);\r\n\r\n    try {\r\n      const response = await axios.post(\r\n        `${serverUrl}/register`,\r\n        {\r\n          name: firstName,\r\n          surname: lastName,\r\n          email: email,\r\n          role: role,\r\n          language: language,\r\n          password: password,\r\n          password2: confirmPassword,\r\n        },\r\n        {\r\n          headers: { Authorization: `Bearer ${authKey}` },\r\n        }\r\n      );\r\n      toast.success(response.data.message);\r\n      setCheckMaster(response.data.checkMaster);\r\n      setAuthorizedUser(response.data.authorizedUser);\r\n      navigate(`/admin/users/${response.data.user._id}`);\r\n      setLoading(false);\r\n    } catch (error) {\r\n      setLoading(false);\r\n      toast.error(error.response?.data?.message || error.message);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <Navbar />\r\n      <main>\r\n        <AdminPanel />\r\n        <section>\r\n          <h1 className=\"title\">Register User</h1>\r\n          <form\r\n            onSubmit={handleSubmit}\r\n            className=\"flex flex-col justify-center items-center w-[90vw]\"\r\n          >\r\n            <UserForm\r\n              page=\"register\"\r\n              checkMaster={checkMaster}\r\n              authorizedUser={authorizedUser}\r\n              loading={loading}\r\n              setFirstName={setFirstName}\r\n              setLastName={setLastName}\r\n              setRole={setRole}\r\n              setLanguage={setLanguage}\r\n              setEmail={setEmail}\r\n              setPassword={setPassword}\r\n              setConfirmPassword={setConfirmPassword}\r\n            />\r\n          </form>\r\n        </section>\r\n      </main>\r\n      <Footer />\r\n    </>\r\n  );\r\n};\r\n\r\nexport default RegisterUser;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}