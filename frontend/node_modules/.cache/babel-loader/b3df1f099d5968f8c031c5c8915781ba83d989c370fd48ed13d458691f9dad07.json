{"ast":null,"code":"import React,{useEffect,useState}from\"react\";import Navbar from\"../../components/Navbar\";import{Link,useLocation,useNavigate}from\"react-router-dom\";import Footer from\"../../components/Footer\";import axios from\"axios\";import{Buffer}from\"buffer\";import{toast}from\"react-toastify\";import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const Products=()=>{const[writingDirection,setWritingDirection]=useState(\"ltr\");const[products,setProducts]=useState([]);const serverUrl=window.location.origin.includes(\"localhost\")?\"http://localhost:5000/products\":\"https://khamco-shop-backend.onrender.com/products\";const authKey=localStorage.getItem(\"jwt\");const[isLoading,setIsLoading]=useState(true);const location=useLocation();const navigate=useNavigate();const getProducts=async function(){let queryParams=arguments.length>0&&arguments[0]!==undefined?arguments[0]:\"\";try{const response=await axios.get(\"\".concat(serverUrl).concat(queryParams),{headers:{Authorization:\"Bearer \".concat(authKey)}});setIsLoading(false);if(response.data.products){setProducts(response.data.products);}else{setProducts([]);}}catch(error){var _error$response,_error$response$data;toast.error(((_error$response=error.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:_error$response$data.message)||error.message);setProducts([]);setIsLoading(false);}};useEffect(()=>{document.title=\"Products Khamco Shop\";getProducts(location.search);},[location.search]);const handleSearch=e=>{e.preventDefault();const form=new FormData(e.target);const searchParams=new URLSearchParams(form).toString();navigate(\"?\".concat(searchParams));};return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Navbar,{}),/*#__PURE__*/_jsx(\"main\",{className:\"p-[4rem]\",children:/*#__PURE__*/_jsxs(\"section\",{id:\"inventory\",className:\"py-0 px-[2rem] grid justify-center items-center grid-cols-1 gap-[1rem]\",dir:writingDirection,children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-between gap-[2rem] items-center my-[2rem] m-auto w-full flex-wrap\",children:/*#__PURE__*/_jsxs(Link,{to:\"/products/new\",children:[\"Add New Product \",/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-cart-plus\"})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between gap-[2rem] items-center my-[2rem] m-auto w-full flex-wrap\",children:[/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSearch,className:\"search-engine\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Search product name\",name:\"name\",className:\"search-input\"}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"search-button\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-search\"})})]}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSearch,className:\"search-engine\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"date\",name:\"date\",id:\"date-search\",className:\"search-input\"}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"search-button\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-check\"})})]})]}),/*#__PURE__*/_jsxs(\"h1\",{className:\"title\",children:[\"All Products (\",products.length||0,\")\"]}),isLoading&&new Array(3).fill(null).map((_,index)=>/*#__PURE__*/_jsx(\"div\",{className:\"w-full bg-[#ccc] animate-pulse py-[6rem] px-[2rem] shadow-md shadow-[#333] rounded-[0.5rem] flex justify-evenly items-center gap-[2rem]\",dir:writingDirection},\"placeholder-\".concat(index))),products.length>0&&products.map((product,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center w-full bg-[#bebebe80] p-[2rem] shadow-md shadow-[#333] rounded-[0.5rem] justify-evenly gap-[2rem] my-[2rem]\",dir:\"auto\",children:[/*#__PURE__*/_jsx(\"img\",{src:\"data:\".concat(product.photoType,\";base64, \").concat(Buffer.from(product.picture.data).toString(\"base64\")),alt:product.name,loading:\"lazy\",className:\"w-[15vw] h-[30vh]\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"capitalize\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Name\"}),\": \",product.name]}),/*#__PURE__*/_jsxs(\"p\",{className:\"capitalize\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Category\"}),\": \",product.category]}),/*#__PURE__*/_jsx(Link,{to:\"/products/\".concat(product._id),className:\"edit-btn transform-none\",children:\"View\"})]},index)),products.length<=0&&!isLoading&&/*#__PURE__*/_jsx(\"p\",{className:\"text-center\",children:\"No product data.\"})]})}),/*#__PURE__*/_jsx(Footer,{})]});};export default Products;","map":{"version":3,"names":["React","useEffect","useState","Navbar","Link","useLocation","useNavigate","Footer","axios","Buffer","toast","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Products","writingDirection","setWritingDirection","products","setProducts","serverUrl","window","location","origin","includes","authKey","localStorage","getItem","isLoading","setIsLoading","navigate","getProducts","queryParams","arguments","length","undefined","response","get","concat","headers","Authorization","data","error","_error$response","_error$response$data","message","document","title","search","handleSearch","e","preventDefault","form","FormData","target","searchParams","URLSearchParams","toString","children","className","id","dir","to","onSubmit","type","placeholder","name","Array","fill","map","_","index","product","src","photoType","from","picture","alt","loading","category","_id"],"sources":["C:/Users/TawandaMsengezi/Documents/Upwork/Osama-Client/Khamco Shop/Shop-1/client/src/pages/products/Products.jsx"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport Navbar from \"../../components/Navbar\";\r\nimport { Link, useLocation, useNavigate } from \"react-router-dom\";\r\nimport Footer from \"../../components/Footer\";\r\nimport axios from \"axios\";\r\nimport { Buffer } from \"buffer\";\r\nimport { toast } from \"react-toastify\";\r\n\r\nconst Products = () => {\r\n  const [writingDirection, setWritingDirection] = useState(\"ltr\");\r\n  const [products, setProducts] = useState([]);\r\n  const serverUrl = window.location.origin.includes(\"localhost\")\r\n    ? \"http://localhost:5000/products\"\r\n    : \"https://khamco-shop-backend.onrender.com/products\";\r\n  const authKey = localStorage.getItem(\"jwt\");\r\n  const [isLoading, setIsLoading] = useState(true);\r\n  const location = useLocation();\r\n  const navigate = useNavigate();\r\n\r\n  const getProducts = async (queryParams = \"\") => {\r\n    try {\r\n      const response = await axios.get(`${serverUrl}${queryParams}`, {\r\n        headers: { Authorization: `Bearer ${authKey}` },\r\n      });\r\n\r\n      setIsLoading(false);\r\n      if (response.data.products) {\r\n        setProducts(response.data.products);\r\n      } else {\r\n        setProducts([]);\r\n      }\r\n    } catch (error) {\r\n      toast.error(error.response?.data?.message || error.message);\r\n      setProducts([]);\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    document.title = \"Products Khamco Shop\";\r\n    getProducts(location.search);\r\n  }, [location.search]);\r\n\r\n  const handleSearch = (e) => {\r\n    e.preventDefault();\r\n    const form = new FormData(e.target);\r\n    const searchParams = new URLSearchParams(form).toString();\r\n    navigate(`?${searchParams}`);\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <Navbar />\r\n      <main className=\"p-[4rem]\">\r\n        <section\r\n          id=\"inventory\"\r\n          className=\"py-0 px-[2rem] grid justify-center items-center grid-cols-1 gap-[1rem]\"\r\n          dir={writingDirection}\r\n        >\r\n          <div className=\"flex justify-between gap-[2rem] items-center my-[2rem] m-auto w-full flex-wrap\">\r\n            <Link to=\"/products/new\">\r\n              Add New Product <i className=\"fas fa-cart-plus\"></i>\r\n            </Link>\r\n          </div>\r\n          <div className=\"flex justify-between gap-[2rem] items-center my-[2rem] m-auto w-full flex-wrap\">\r\n            <form onSubmit={handleSearch} className=\"search-engine\">\r\n              <input\r\n                type=\"text\"\r\n                placeholder=\"Search product name\"\r\n                name=\"name\"\r\n                className=\"search-input\"\r\n              />\r\n              <button type=\"submit\" className=\"search-button\">\r\n                <i className=\"fas fa-search\"></i>\r\n              </button>\r\n            </form>\r\n            <form onSubmit={handleSearch} className=\"search-engine\">\r\n              <input\r\n                type=\"date\"\r\n                name=\"date\"\r\n                id=\"date-search\"\r\n                className=\"search-input\"\r\n              />\r\n              <button type=\"submit\" className=\"search-button\">\r\n                <i className=\"fas fa-check\"></i>\r\n              </button>\r\n            </form>\r\n          </div>\r\n          <h1 className=\"title\">All Products ({products.length || 0})</h1>\r\n          {isLoading &&\r\n            new Array(3)\r\n              .fill(null)\r\n              .map((_, index) => (\r\n                <div\r\n                  key={`placeholder-${index}`}\r\n                  className=\"w-full bg-[#ccc] animate-pulse py-[6rem] px-[2rem] shadow-md shadow-[#333] rounded-[0.5rem] flex justify-evenly items-center gap-[2rem]\"\r\n                  dir={writingDirection}\r\n                ></div>\r\n              ))}\r\n          {products.length > 0 &&\r\n            products.map((product, index) => (\r\n              <div\r\n                key={index}\r\n                className=\"flex items-center w-full bg-[#bebebe80] p-[2rem] shadow-md shadow-[#333] rounded-[0.5rem] justify-evenly gap-[2rem] my-[2rem]\"\r\n                dir=\"auto\"\r\n              >\r\n                <img\r\n                  src={`data:${product.photoType};base64, ${Buffer.from(\r\n                    product.picture.data\r\n                  ).toString(\"base64\")}`}\r\n                  alt={product.name}\r\n                  loading=\"lazy\"\r\n                  className=\"w-[15vw] h-[30vh]\"\r\n                />\r\n                <p className=\"capitalize\">\r\n                  <strong>Name</strong>: {product.name}\r\n                </p>\r\n                <p className=\"capitalize\">\r\n                  <strong>Category</strong>: {product.category}\r\n                </p>\r\n                <Link\r\n                  to={`/products/${product._id}`}\r\n                  className=\"edit-btn transform-none\"\r\n                >\r\n                  View\r\n                </Link>\r\n              </div>\r\n            ))}\r\n\r\n          {products.length <= 0 && !isLoading && (\r\n            <p className=\"text-center\">No product data.</p>\r\n          )}\r\n        </section>\r\n      </main>\r\n      <Footer />\r\n    </>\r\n  );\r\n};\r\n\r\nexport default Products;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}