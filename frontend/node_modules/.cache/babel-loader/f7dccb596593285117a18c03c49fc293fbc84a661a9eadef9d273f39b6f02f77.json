{"ast":null,"code":"import React,{useEffect,useState}from\"react\";import Navbar from\"../../components/Navbar\";import{Link,useLocation,useNavigate,useParams}from\"react-router-dom\";import Footer from\"../../components/Footer\";import{useStoreState}from\"easy-peasy\";import axios from\"axios\";import{toast}from\"react-toastify\";import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const CustomerInvoices=()=>{const{id}=useParams();const[invoices,setInvoices]=useState(null);const[customer,setCustomer]=useState(null);const userLanguage=useStoreState(state=>state.userLanguage);const[writingDirection,setWritingDirection]=useState(\"ltr\");const apiUrl=window.location.origin.includes(\"localhost\")?\"http://localhost:5000/customers/\".concat(id,\"/invoices\"):\"https://khamco-shop-backend.onrender.com/customers/\".concat(id,\"/invoices\");const authKey=localStorage.getItem(\"jwt\");const navigate=useNavigate();const location=useLocation();const[loading,setLoading]=useState(true);const[display,setDisplay]=useState(false);const fetchData=async function(){let queryParams=arguments.length>0&&arguments[0]!==undefined?arguments[0]:\"\";await axios.get(\"\".concat(apiUrl).concat(queryParams),{headers:{Authorization:\"Bearer \".concat(authKey)}}).then(response=>{setCustomer(response.data.customer);setInvoices(response.data.invoices);setLoading(false);setDisplay(true);}).catch(error=>{toast.error(error.message);setCustomer(null);setLoading(true);setLoading(false);setInvoices(null);});};useEffect(()=>{const determineWritingDirection=()=>{if(userLanguage===\"ar\"||userLanguage===\"ur\"){setWritingDirection(\"rtl\");}else{setWritingDirection(\"ltr\");}};determineWritingDirection();fetchData(location.search);},[apiUrl,authKey,userLanguage,location.search]);const handleSearch=e=>{e.preventDefault();const form=new FormData(e.target);const searchParams=new URLSearchParams(form).toString();navigate(\"?\".concat(searchParams));};return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Navbar,{}),/*#__PURE__*/_jsx(\"main\",{children:/*#__PURE__*/_jsxs(\"section\",{id:\"customer-page\",className:\"py-0 px-[2rem] grid justify-center items-center grid-cols-1 gap-[1rem]\",dir:writingDirection,children:[loading&&new Array(3).fill(null).map((_,index)=>/*#__PURE__*/_jsx(\"div\",{className:\"w-full bg-[#ccc] animate-pulse py-[4rem] px-[2rem] shadow-md shadow-[#333] rounded-[0.5rem] flex justify-evenly items-center gap-[2rem]\",dir:writingDirection},\"placeholder-\".concat(index))),display&&invoices&&customer&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"utilities\",children:/*#__PURE__*/_jsxs(Link,{to:\"/customers/\".concat(customer._id),children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-arrow-left\"}),\" Customer \".concat(customer.name,\" \").concat(customer.surname)]})}),/*#__PURE__*/_jsx(\"div\",{className:\"utilities\",children:/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSearch,className:\"search-engine\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"date\",name:\"date\",className:\"search-input\"}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"search-button\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-check\"})})]})}),/*#__PURE__*/_jsx(\"h1\",{className:\"title\",children:\"All Invoices for \".concat(customer.name,\" \").concat(customer.surname,\" (\").concat(invoices.length,\")\")}),invoices&&invoices.length>0?invoices.map((invoice,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"w-full bg-[#bebebe80] p-[2rem] shadow-lg shadow-[#333] rounded-[0.5rem] flex justify-evenly items-center gap-[2rem] my-[1rem]\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"capitalize\",children:[/*#__PURE__*/_jsx(\"strong\",{className:\"text-khamco-secondary text-lg\",children:\"Date\"}),\":\",\" \",new Date(invoice.date).toLocaleDateString(\"en-US\",{month:\"long\",day:\"numeric\",year:\"numeric\"})]}),/*#__PURE__*/_jsxs(\"p\",{className:\"capitalize\",children:[/*#__PURE__*/_jsx(\"strong\",{className:\"text-khamco-secondary text-lg\",children:\"Payment Status:\"}),\" \",invoice.payment_status]}),/*#__PURE__*/_jsxs(\"p\",{className:\"capitalize\",children:[/*#__PURE__*/_jsx(\"strong\",{className:\"text-khamco-secondary text-lg\",children:\"Membership:\"}),\" \",customer.membership_status===\"VIP\"?/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-star blink\",children:\"VIP\"}):\"Basic\"]}),/*#__PURE__*/_jsx(Link,{to:\"/invoices/\".concat(invoice._id),className:\"edit-btn\",children:\"View\"})]},index)):/*#__PURE__*/_jsx(\"p\",{className:\"text-center\",children:\"This customer has no invoices.\"})]})]})}),/*#__PURE__*/_jsx(Footer,{})]});};export default CustomerInvoices;","map":{"version":3,"names":["React","useEffect","useState","Navbar","Link","useLocation","useNavigate","useParams","Footer","useStoreState","axios","toast","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","CustomerInvoices","id","invoices","setInvoices","customer","setCustomer","userLanguage","state","writingDirection","setWritingDirection","apiUrl","window","location","origin","includes","concat","authKey","localStorage","getItem","navigate","loading","setLoading","display","setDisplay","fetchData","queryParams","arguments","length","undefined","get","headers","Authorization","then","response","data","catch","error","message","determineWritingDirection","search","handleSearch","e","preventDefault","form","FormData","target","searchParams","URLSearchParams","toString","children","className","dir","Array","fill","map","_","index","to","_id","name","surname","onSubmit","type","invoice","Date","date","toLocaleDateString","month","day","year","payment_status","membership_status"],"sources":["C:/Users/TawandaMsengezi/Documents/Upwork/Osama-Client/Khamco Shop/Shop-1/client/src/pages/customers/CustomerInvoices.jsx"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport Navbar from \"../../components/Navbar\";\r\nimport { Link, useLocation, useNavigate, useParams } from \"react-router-dom\";\r\nimport Footer from \"../../components/Footer\";\r\nimport { useStoreState } from \"easy-peasy\";\r\nimport axios from \"axios\";\r\nimport { toast } from \"react-toastify\";\r\n\r\nconst CustomerInvoices = () => {\r\n  const { id } = useParams();\r\n  const [invoices, setInvoices] = useState(null);\r\n  const [customer, setCustomer] = useState(null);\r\n  const userLanguage = useStoreState((state) => state.userLanguage);\r\n  const [writingDirection, setWritingDirection] = useState(\"ltr\");\r\n  const apiUrl = window.location.origin.includes(\"localhost\")\r\n    ? `http://localhost:5000/customers/${id}/invoices`\r\n    : `https://khamco-shop-backend.onrender.com/customers/${id}/invoices`;\r\n  const authKey = localStorage.getItem(\"jwt\");\r\n  const navigate = useNavigate();\r\n  const location = useLocation();\r\n  const [loading, setLoading] = useState(true);\r\n  const [display, setDisplay] = useState(false);\r\n\r\n  const fetchData = async (queryParams = \"\") => {\r\n    await axios\r\n      .get(`${apiUrl}${queryParams}`, {\r\n        headers: { Authorization: `Bearer ${authKey}` },\r\n      })\r\n      .then((response) => {\r\n        setCustomer(response.data.customer);\r\n        setInvoices(response.data.invoices);\r\n        setLoading(false);\r\n        setDisplay(true);\r\n      })\r\n      .catch((error) => {\r\n        toast.error(error.message);\r\n        setCustomer(null);\r\n        setLoading(true);\r\n        setLoading(false);\r\n        setInvoices(null);\r\n      });\r\n  };\r\n\r\n  useEffect(() => {\r\n    const determineWritingDirection = () => {\r\n      if (userLanguage === \"ar\" || userLanguage === \"ur\") {\r\n        setWritingDirection(\"rtl\");\r\n      } else {\r\n        setWritingDirection(\"ltr\");\r\n      }\r\n    };\r\n    determineWritingDirection();\r\n    fetchData(location.search);\r\n  }, [apiUrl, authKey, userLanguage, location.search]);\r\n\r\n  const handleSearch = (e) => {\r\n    e.preventDefault();\r\n    const form = new FormData(e.target);\r\n    const searchParams = new URLSearchParams(form).toString();\r\n    navigate(`?${searchParams}`);\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <Navbar />\r\n      <main>\r\n        <section\r\n          id=\"customer-page\"\r\n          className=\"py-0 px-[2rem] grid justify-center items-center grid-cols-1 gap-[1rem]\"\r\n          dir={writingDirection}\r\n        >\r\n          {loading &&\r\n            new Array(3)\r\n              .fill(null)\r\n              .map((_, index) => (\r\n                <div\r\n                  key={`placeholder-${index}`}\r\n                  className=\"w-full bg-[#ccc] animate-pulse py-[4rem] px-[2rem] shadow-md shadow-[#333] rounded-[0.5rem] flex justify-evenly items-center gap-[2rem]\"\r\n                  dir={writingDirection}\r\n                ></div>\r\n              ))}\r\n          {display && invoices && customer && (\r\n            <>\r\n              <div className=\"utilities\">\r\n                <Link to={`/customers/${customer._id}`}>\r\n                  <i className=\"fas fa-arrow-left\"></i>\r\n                  {` Customer ${customer.name} ${customer.surname}`}\r\n                </Link>\r\n              </div>\r\n              <div className=\"utilities\">\r\n                <form onSubmit={handleSearch} className=\"search-engine\">\r\n                  <input type=\"date\" name=\"date\" className=\"search-input\" />\r\n                  <button type=\"submit\" className=\"search-button\">\r\n                    <i className=\"fas fa-check\"></i>\r\n                  </button>\r\n                </form>\r\n              </div>\r\n              <h1 className=\"title\">{`All Invoices for ${customer.name} ${customer.surname} (${invoices.length})`}</h1>\r\n              {invoices && invoices.length > 0 ? (\r\n                invoices.map((invoice, index) => (\r\n                  <div\r\n                    className=\"w-full bg-[#bebebe80] p-[2rem] shadow-lg shadow-[#333] rounded-[0.5rem] flex justify-evenly items-center gap-[2rem] my-[1rem]\"\r\n                    key={index}\r\n                  >\r\n                    <p className=\"capitalize\">\r\n                      <strong className=\"text-khamco-secondary text-lg\">\r\n                        Date\r\n                      </strong>\r\n                      :{\" \"}\r\n                      {new Date(invoice.date).toLocaleDateString(\"en-US\", {\r\n                        month: \"long\",\r\n                        day: \"numeric\",\r\n                        year: \"numeric\",\r\n                      })}\r\n                    </p>\r\n                    <p className=\"capitalize\">\r\n                      <strong className=\"text-khamco-secondary text-lg\">\r\n                        Payment Status:\r\n                      </strong>{\" \"}\r\n                      {invoice.payment_status}\r\n                    </p>\r\n                    <p className=\"capitalize\">\r\n                      <strong className=\"text-khamco-secondary text-lg\">\r\n                        Membership:\r\n                      </strong>{\" \"}\r\n                      {customer.membership_status === \"VIP\" ? (\r\n                        <i className=\"fas fa-star blink\">VIP</i>\r\n                      ) : (\r\n                        \"Basic\"\r\n                      )}\r\n                    </p>\r\n                    <Link to={`/invoices/${invoice._id}`} className=\"edit-btn\">\r\n                      View\r\n                    </Link>\r\n                  </div>\r\n                ))\r\n              ) : (\r\n                <p className=\"text-center\">This customer has no invoices.</p>\r\n              )}\r\n            </>\r\n          )}\r\n        </section>\r\n      </main>\r\n      <Footer />\r\n    </>\r\n  );\r\n};\r\n\r\nexport default CustomerInvoices;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}