{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\TawandaMsengezi\\\\Documents\\\\Upwork\\\\Osama-Client\\\\Khamco Shop\\\\Shop-1\\\\client\\\\src\\\\App.js\",\n  _s = $RefreshSig$();\nimport { Routes, Route, Navigate, useNavigate } from \"react-router-dom\";\nimport Login from \"./pages/Login\";\nimport NotFound from \"./pages/404\";\nimport { Suspense, useCallback, useEffect } from \"react\";\nimport { Slide, toast, ToastContainer } from \"react-toastify\";\nimport \"react-toastify/dist/ReactToastify.css\";\nimport { useStoreActions } from \"easy-peasy\";\nimport { jwtDecode } from \"jwt-decode\";\nimport { appRoutes } from \"./routes\";\nimport ScrollToTop from \"./components/ScrollToTop\";\nimport ForgotPassword from \"./pages/users/ForgotPassword\";\nimport ResetPassword from \"./pages/users/ResetPassword\";\nimport axios from \"axios\";\nimport { useTranslation } from \"react-i18next\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction App() {\n  _s();\n  const authKey = localStorage.getItem(\"jwt\");\n  const setUser = useStoreActions(state => state.setUser);\n  const navigate = useNavigate();\n  const {\n    i18n\n  } = useTranslation();\n  document.body.dir = i18n.dir();\n  useEffect(() => {\n    const isTokenExpired = token => {\n      try {\n        const decoded = jwtDecode(token);\n        return Date.now() >= decoded.exp * 1000;\n      } catch (error) {\n        console.error(\"Token parsing error:\", error);\n        return true;\n      }\n    };\n    const token = localStorage.getItem(\"jwt\");\n    if (!token || isTokenExpired(token)) {\n      localStorage.clear();\n      navigate(\"/users/login\");\n      toast.warn(\"Session expired. Please log in again.\");\n    } else {\n      // Token is valid, proceed with user setup\n      const decoded = jwtDecode(token);\n      setUser({\n        id: decoded.id,\n        email: decoded.email,\n        role: Array.isArray(decoded.role) ? decoded.role : [decoded.role],\n        // Ensure roles are stored as an array\n        language: decoded.language\n      });\n    }\n  }, [navigate, setUser]);\n  useEffect(() => {\n    const interceptor = axios.interceptors.response.use(response => response, error => {\n      if (error.response && error.response.status === 401) {\n        localStorage.clear();\n        navigate(\"/users/login\");\n        toast.warn(\"Session expired. Please log in again.\");\n      } else if (error.response && error.response.status === 403) {\n        toast.warn(\"You are not authorized.\");\n        navigate(\"/\");\n      }\n      return Promise.reject(error);\n    });\n    return () => {\n      axios.interceptors.response.eject(interceptor);\n    };\n  }, [navigate]);\n  return /*#__PURE__*/_jsxDEV(Suspense, {\n    fallback: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"w-screen h-screen flex items-center justify-center\",\n      children: /*#__PURE__*/_jsxDEV(\"i\", {\n        className: \"text-[5rem] text-khamco-ribbon fas fa-spinner animate-spin\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 77,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 9\n    }, this),\n    children: [/*#__PURE__*/_jsxDEV(ScrollToTop, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Routes, {\n      children: [/*#__PURE__*/_jsxDEV(Route, {\n        exact: true,\n        path: \"/users/login\",\n        element: /*#__PURE__*/_jsxDEV(Login, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 83,\n          columnNumber: 51\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 83,\n        columnNumber: 9\n      }, this), appRoutes.map(route => /*#__PURE__*/_jsxDEV(Route, {\n        exact: true,\n        path: route.path,\n        element: authKey ? /*#__PURE__*/_jsxDEV(route.component, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 90,\n          columnNumber: 25\n        }, this) : /*#__PURE__*/_jsxDEV(Navigate, {\n          to: \"/users/login\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 90,\n          columnNumber: 47\n        }, this)\n      }, route.path, false, {\n        fileName: _jsxFileName,\n        lineNumber: 85,\n        columnNumber: 11\n      }, this)), /*#__PURE__*/_jsxDEV(Route, {\n        exact: true,\n        path: \"/users/forgot-password\",\n        element: /*#__PURE__*/_jsxDEV(ForgotPassword, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 98,\n          columnNumber: 20\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Route, {\n        exact: true,\n        path: \"/users/reset-password/:token\",\n        element: /*#__PURE__*/_jsxDEV(ResetPassword, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 103,\n          columnNumber: 20\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Route, {\n        exact: true,\n        path: \"/unauthorized\",\n        element: /*#__PURE__*/_jsxDEV(NotFound, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 105,\n          columnNumber: 52\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 105,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Route, {\n        exact: true,\n        path: \"*\",\n        element: /*#__PURE__*/_jsxDEV(NotFound, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 106,\n          columnNumber: 40\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 106,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(ToastContainer, {\n      position: \"top-right\",\n      hideProgressBar: false,\n      newestOnTop: true,\n      closeOnClick: true,\n      rtl: false,\n      pauseOnFocusLoss: true,\n      draggable: true,\n      pauseOnHover: true,\n      theme: \"light\",\n      transition: Slide,\n      autoClose: 5000\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 74,\n    columnNumber: 5\n  }, this);\n}\n_s(App, \"WWAe84xAL7EhVJJWqmvm8owAp04=\", false, function () {\n  return [useStoreActions, useNavigate, useTranslation];\n});\n_c = App;\nexport default App;\nvar _c;\n$RefreshReg$(_c, \"App\");","map":{"version":3,"names":["Routes","Route","Navigate","useNavigate","Login","NotFound","Suspense","useCallback","useEffect","Slide","toast","ToastContainer","useStoreActions","jwtDecode","appRoutes","ScrollToTop","ForgotPassword","ResetPassword","axios","useTranslation","jsxDEV","_jsxDEV","App","_s","authKey","localStorage","getItem","setUser","state","navigate","i18n","document","body","dir","isTokenExpired","token","decoded","Date","now","exp","error","console","clear","warn","id","email","role","Array","isArray","language","interceptor","interceptors","response","use","status","Promise","reject","eject","fallback","className","children","fileName","_jsxFileName","lineNumber","columnNumber","exact","path","element","map","route","component","to","position","hideProgressBar","newestOnTop","closeOnClick","rtl","pauseOnFocusLoss","draggable","pauseOnHover","theme","transition","autoClose","_c","$RefreshReg$"],"sources":["C:/Users/TawandaMsengezi/Documents/Upwork/Osama-Client/Khamco Shop/Shop-1/client/src/App.js"],"sourcesContent":["import { Routes, Route, Navigate, useNavigate } from \"react-router-dom\";\nimport Login from \"./pages/Login\";\nimport NotFound from \"./pages/404\";\nimport { Suspense, useCallback, useEffect } from \"react\";\nimport { Slide, toast, ToastContainer } from \"react-toastify\";\nimport \"react-toastify/dist/ReactToastify.css\";\nimport { useStoreActions } from \"easy-peasy\";\nimport { jwtDecode } from \"jwt-decode\";\nimport { appRoutes } from \"./routes\";\nimport ScrollToTop from \"./components/ScrollToTop\";\nimport ForgotPassword from \"./pages/users/ForgotPassword\";\nimport ResetPassword from \"./pages/users/ResetPassword\";\nimport axios from \"axios\";\nimport { useTranslation } from \"react-i18next\";\n\nfunction App() {\n  const authKey = localStorage.getItem(\"jwt\");\n  const setUser = useStoreActions((state) => state.setUser);\n  const navigate = useNavigate();\n  const { i18n } = useTranslation();\n\n  document.body.dir = i18n.dir();\n\n  useEffect(() => {\n    const isTokenExpired = (token) => {\n      try {\n        const decoded = jwtDecode(token);\n        return Date.now() >= decoded.exp * 1000;\n      } catch (error) {\n        console.error(\"Token parsing error:\", error);\n        return true;\n      }\n    };\n    const token = localStorage.getItem(\"jwt\");\n\n    if (!token || isTokenExpired(token)) {\n      localStorage.clear();\n      navigate(\"/users/login\");\n      toast.warn(\"Session expired. Please log in again.\");\n    } else {\n      // Token is valid, proceed with user setup\n      const decoded = jwtDecode(token);\n      setUser({\n        id: decoded.id,\n        email: decoded.email,\n        role: Array.isArray(decoded.role) ? decoded.role : [decoded.role], // Ensure roles are stored as an array\n        language: decoded.language,\n      });\n    }\n  }, [navigate, setUser]);\n\n  useEffect(() => {\n    const interceptor = axios.interceptors.response.use(\n      (response) => response,\n      (error) => {\n        if (error.response && error.response.status === 401) {\n          localStorage.clear();\n          navigate(\"/users/login\");\n          toast.warn(\"Session expired. Please log in again.\");\n        } else if (error.response && error.response.status === 403) {\n          toast.warn(\"You are not authorized.\");\n          navigate(\"/\");\n        }\n        return Promise.reject(error);\n      }\n    );\n\n    return () => {\n      axios.interceptors.response.eject(interceptor);\n    };\n  }, [navigate]);\n\n  return (\n    <Suspense\n      fallback={\n        <div className=\"w-screen h-screen flex items-center justify-center\">\n          <i className=\"text-[5rem] text-khamco-ribbon fas fa-spinner animate-spin\"></i>\n        </div>\n      }\n    >\n      <ScrollToTop />\n      <Routes>\n        <Route exact path=\"/users/login\" element={<Login />} />\n        {appRoutes.map((route) => (\n          <Route\n            key={route.path}\n            exact\n            path={route.path}\n            element={\n              authKey ? <route.component /> : <Navigate to=\"/users/login\" />\n            }\n          />\n        ))}\n        {/* Misc Routes */}\n        <Route\n          exact\n          path=\"/users/forgot-password\"\n          element={<ForgotPassword />}\n        />\n        <Route\n          exact\n          path=\"/users/reset-password/:token\"\n          element={<ResetPassword />}\n        />\n        <Route exact path=\"/unauthorized\" element={<NotFound />} />\n        <Route exact path=\"*\" element={<NotFound />} />\n      </Routes>\n      <ToastContainer\n        position=\"top-right\"\n        hideProgressBar={false}\n        newestOnTop={true}\n        closeOnClick\n        rtl={false}\n        pauseOnFocusLoss\n        draggable\n        pauseOnHover\n        theme=\"light\"\n        transition={Slide}\n        autoClose={5000}\n      />\n    </Suspense>\n  );\n}\n\nexport default App;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}